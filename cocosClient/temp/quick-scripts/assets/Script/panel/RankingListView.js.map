{"version":3,"sources":["RankingListView.ts"],"names":[],"mappings":";;;;;AAAA,8CAA6C;AAC7C,0CAAyC;AACzC,kCAA2C;AAC3C,4CAA2C;AAGrC,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAQ,CAAkB;AAG1C;IAAsC,mCAAY;IAAlD;;IAkGA,CAAC;IAlFG,gCAAM,GAAN;IAEA,CAAC;IAED,+BAAK,GAAL;QACI,yBAAW,CAAC,oBAAoB,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,EAAE,gBAAgB,CAAC,CAAC;QAC1E,yBAAW,CAAC,oBAAoB,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW,EAAE,iBAAiB,CAAC,CAAC;QAE5E,cAAc;QACd,+EAA+E;QAE/E,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,EAAE;YAC1B,IAAI,SAAS,GAAG,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;YAC9B,SAAS,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;YAChD,SAAS,CAAC,WAAW,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YACjC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;SACjC;QAED,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,EAAE,CAAC,GAAG,CAAC,WAAW,EAAE;YACxC,IAAI,CAAC,GAAG,GAAG,IAAI,EAAE,CAAC,SAAS,EAAE,CAAC;YAC9B,SAAS;YACT,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;YACxB,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,EAAE;gBAC1B,EAAE,CAAC,WAAW,CAAC;oBACX,WAAW,EAAE,CAAC;oBACd,aAAa,EAAE,uBAAU,CAAC,aAAa;oBACvC,WAAW,EAAE,IAAI,CAAC,WAAW;iBAChC,CAAC,CAAC;aACN;iBAAM;gBACH,EAAE,CAAC,WAAW,CAAC;oBACX,WAAW,EAAE,CAAC;oBACd,aAAa,EAAE,uBAAU,CAAC,aAAa;iBAC1C,CAAC,CAAC;aACN;SACJ;aAAM;YACH,IAAI,YAAY,GAAG,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;YACjC,YAAY,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,SAAS,CAAC;YACvD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;YACjC,EAAE,CAAC,GAAG,CAAC,UAAU,GAAG,uBAAU,CAAC,aAAa,CAAC,CAAC;SACjD;IAEL,CAAC;IAED,UAAU;IACV,gDAAsB,GAAtB;QACI,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,EAAE,CAAC,GAAG,CAAC,WAAW,EAAE;YACxC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;gBACX,OAAO;aACR;YACD,IAAI,eAAe,GAAG,EAAE,CAAC,kBAAkB,EAAE,CAAC;YAC9C,IAAI,YAAY,GAAG,eAAe,CAAC,MAAM,CAAC;YAC1C,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;YACvC,IAAI,CAAC,GAAG,CAAC,mBAAmB,EAAE,CAAC;YAC/B,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,IAAI,EAAE,CAAC,WAAW,CAC7E,IAAI,CAAC,GAAG,CACT,CAAC;SACP;IACL,CAAC;IACD,gCAAM,GAAN;QACI,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAClC,CAAC;IAED,IAAI;IACJ,yCAAe,GAAf,UAAgB,KAAK;QACjB,qBAAS,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QACnC,UAAU,CAAC;YACP,uBAAe,CAAC,aAAa,CAAC,CAAC;QACnC,CAAC,EAAE,GAAG,CAAC,CAAC;IACZ,CAAC;IAED,IAAI;IACJ,wCAAc,GAAd,UAAe,KAAK;QAChB,qBAAS,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QACnC,qBAAS,CAAC,cAAc,EAAE,CAAC;QAC3B,IAAI,EAAE,CAAC,GAAG,CAAC,QAAQ,KAAK,EAAE,CAAC,GAAG,CAAC,WAAW,EAAE;YACxC,EAAE,CAAC,WAAW,CAAC;gBACX,WAAW,EAAE,CAAC;gBACd,aAAa,EAAE,uBAAU,CAAC,aAAa;aAC1C,CAAC,CAAC;SACN;QACD,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACxB,CAAC;IA9FD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;uDACE;IAGpB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;wDACG;IAGrB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;8DACW;IAG7B;QADC,QAAQ,CAAC,MAAM,CAAC;wDACG;IAZV,eAAe;QAD5B,OAAO;OACM,eAAe,CAkG5B;IAAD,sBAAC;CAlGD,AAkGC,CAlGqC,EAAE,CAAC,SAAS,GAkGjD;AAlGa,0CAAe","file":"","sourceRoot":"../../../../../assets/Script/panel","sourcesContent":["import { gameUiTools } from \"../GameUiTools\";\nimport { gameTools } from \"../GameTools\";\nimport { shareAppMessage } from \"../mySDK\";\nimport { GameConfig } from \"../GameConfig\";\n\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport  class RankingListView extends cc.Component {\n\n    @property(cc.Node)\n    backButton: cc.Node;\n\n    @property(cc.Node)\n    shareButton: cc.Node;\n\n    @property(cc.Node)\n    rankingScrollView: cc.Sprite;\n\n    @property(String)\n    shareTicket: String;\n\n\n    tex:cc.Texture2D;\n    onLoad() {\n        \n    }\n     \n    start(){\n        gameUiTools.setButtonClickEvents(this, this.backButton, \"backButtonFunc\");\n        gameUiTools.setButtonClickEvents(this, this.shareButton, \"shareButtonFunc\");\n\n        //TODO 需要做一个提示\n        //AnimLayerTool.createShowMessageBox(120, -350, \"分享到群里可查看群排行榜！\", 0, this.node);\n\n        if (this.shareTicket != null) {\n            let shareNode = new cc.Node();\n            shareNode.addComponent(cc.Label).string = \"群排行\";\n            shareNode.setPosition(-260, 503);\n            this.node.addChild(shareNode);\n        }\n\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\n            this.tex = new cc.Texture2D();\n            // 发消息给子域\n            cc.log(this.shareTicket)\n            if (this.shareTicket != null) {\n                wx.postMessage({\n                    messageType: 5,\n                    MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n                    shareTicket: this.shareTicket\n                });\n            } else {\n                wx.postMessage({\n                    messageType: 1,\n                    MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n                });\n            }\n        } else {\n            let gameTypeNode = new cc.Node();\n            gameTypeNode.addComponent(cc.Label).string = \"暂无排行榜数据\";\n            this.node.addChild(gameTypeNode);\n            cc.log(\"获取排行榜数据。\" + GameConfig.MAIN_MENU_NUM);\n        }\n\n    }\n\n    // 刷新子域的纹理\n    _updateSubDomainCanvas() {\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\n            if (!this.tex) {\n                return;\n              }\n              var openDataContext = wx.getOpenDataContext();\n              var sharedCanvas = openDataContext.canvas;\n              this.tex.initWithElement(sharedCanvas);\n              this.tex.handleLoadedTexture();\n              this.rankingScrollView.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(\n                this.tex\n              );\n        }\n    }\n    update() {\n        this._updateSubDomainCanvas();\n    }\n\n    //分享\n    shareButtonFunc(event){\n        gameTools.playSimpleAudioEngine(4);\n        setTimeout(() => {\n            shareAppMessage(\"shareTicket\");\n        }, 100);\n    }\n\n    //返回\n    backButtonFunc(event) {\n        gameTools.playSimpleAudioEngine(0);\n        gameTools.removeRankData();\n        if (cc.sys.platform === cc.sys.WECHAT_GAME) {\n            wx.postMessage({// 发消息给子域\n                messageType: 4,\n                MAIN_MENU_NUM: GameConfig.MAIN_MENU_NUM,\n            });\n        }\n        this.node.destroy();\n    }\n}\n"]}